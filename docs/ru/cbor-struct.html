<html>
	<head></head>
	<body>
		<div class="markdown prose w-full break-words dark:prose-invert light"><p>CBOR (Concise Binary Object Representation) представляет данные в компактном бинарном формате. CBOR разделяет типы данных на основные и использует первые три бита первого байта для обозначения типа данных. Вот краткий обзор типов данных CBOR и их кодирования:</p><hr><h3>Основные типы данных в CBOR</h3><table><thead><tr><th>Тип данных</th><th>Дополнительная информация</th><th>Начальный байт (биты)</th><th>Описание</th></tr></thead><tbody><tr><td><strong>Unsigned Integer</strong></td><td>Беззнаковое целое число</td><td><code>0b000</code> (0x00–0x17)</td><td>Значения от 0 до 23 кодируются прямо в байте. Большие значения используют дополнительные байты.</td></tr><tr><td><strong>Negative Integer</strong></td><td>Отрицательное целое число</td><td><code>0b001</code> (0x20–0x37)</td><td>Значение кодируется как -(n + 1), где n — значение. Аналогично, большие числа требуют дополнительных байтов.</td></tr><tr><td><strong>Byte String</strong></td><td>Последовательность байтов</td><td><code>0b010</code> (0x40–0x57)</td><td>Указывает длину строки, за которой идут сами байты.</td></tr><tr><td><strong>Text String</strong></td><td>Последовательность UTF-8 символов</td><td><code>0b011</code> (0x60–0x77)</td><td>Аналогично строке байтов, но содержит текстовые символы.</td></tr><tr><td><strong>Array</strong></td><td>Последовательность элементов</td><td><code>0b100</code> (0x80–0x97)</td><td>Указывает количество элементов в массиве.</td></tr><tr><td><strong>Map (Dictionary)</strong></td><td>Набор пар ключ-значение</td><td><code>0b101</code> (0xA0–0xB7)</td><td>Указывает количество пар ключ-значение.</td></tr><tr><td><strong>Semantic Tag</strong></td><td>Тег для семантической аннотации</td><td><code>0b110</code> (0xC0–0xD7)</td><td>Указывает семантику данных (например, формат даты/времени).</td></tr><tr><td><strong>Simple Value/Float</strong></td><td>Простое значение или число с плавающей точкой</td><td><code>0b111</code> (0xE0–0xFF)</td><td>Прочие значения, включая логические (<code>true</code>, <code>false</code>), <code>null</code>, <code>undefined</code>, и числа с плавающей точкой.</td></tr></tbody></table><hr><h3>Подробное кодирование основных типов</h3><h4>1. <strong>Unsigned Integer</strong></h4><ul><li>Кодируется напрямую, если значение ≤ 23.</li><li>Значения &gt; 23 используют дополнительные байты:<ul><li><code>0x18</code> + 1 байт: значения до 255.</li><li><code>0x19</code> + 2 байта: значения до 65535.</li><li><code>0x1A</code> + 4 байта: значения до 2^32 - 1.</li><li><code>0x1B</code> + 8 байт: значения до 2^64 - 1.</li><li><code>0x1F</code> (Длина не определена)</li></ul></li></ul><h4>2. <strong>Negative Integer</strong></h4><ul><li>Кодируется как <code>-(n + 1)</code>.</li><li>Аналогично беззнаковым числам:<ul><li><code>0x20–0x37</code>: значения от -1 до -24.</li><li>Дополнительные байты для больших значений (начиная с <code>0x38</code>).</li></ul></li></ul><h4>3. <strong>Byte String</strong></h4><ul><li>Начальный байт: <code>0x40</code> + длина строки (до 23 байт).</li><li>Для длинных строк:<ul><li><code>0x58</code> + 1 байт длины.</li><li><code>0x59</code> + 2 байта длины.</li><li><code>0x5A</code> + 4 байта длины.</li><li><code>0x5B</code> + 8 байт длины.</li></ul></li></ul><h4>4. <strong>Text String</strong></h4><ul><li>Кодирование аналогично строке байтов, но данные интерпретируются как UTF-8.</li></ul><h4>5. <strong>Array</strong></h4><ul><li>Начальный байт: <code>0x80</code> + количество элементов (до 23 элементов).</li><li>Для больших массивов:<ul><li><code>0x98</code> + 1 байт длины.</li><li><code>0x99</code> + 2 байта длины.</li><li><code>0x9A</code> + 4 байта длины.</li><li><code>0x9B</code> + 8 байт длины.</li></ul></li><li>За начальным байтом идут закодированные элементы массива.</li></ul><h4>6. <strong>Map (Dictionary)</strong></h4><ul><li>Начальный байт: <code>0xA0</code> + количество пар ключ-значение (до 23 пар).</li><li>Для больших словарей:<ul><li><code>0xB8</code> + 1 байт длины.</li><li><code>0xB9</code> + 2 байта длины.</li><li><code>0xBA</code> + 4 байта длины.</li><li><code>0xBB</code> + 8 байт длины.</li></ul></li><li>За начальным байтом идут закодированные ключи и значения.</li></ul><h4>7. <strong>Semantic Tag</strong></h4><ul><li>Начальный байт: <code>0xC0–0xD7</code>.</li><li>Пример: <code>0xC1</code> может обозначать дату/время.</li></ul><h4>8. <strong>Simple Value / Float</strong></h4><ul><li>Простые значения (<code>true</code>, <code>false</code>, <code>null</code> и т. д.):<ul><li><code>0xF4</code>: false.</li><li><code>0xF5</code>: true.</li><li><code>0xF6</code>: null.</li><li><code>0xF7</code>: undefined.</li></ul></li><li>Числа с плавающей точкой:<ul><li><code>0xFA</code> + 4 байта (32-битное значение).</li><li><code>0xFB</code> + 8 байт (64-битное значение).</li></ul></li></ul><hr><h3>Пример: CBOR для JSON <code>{"key": true, "value": 42}</code></h3><ol><li><strong>Map</strong> с двумя парами → <code>0xA2</code>.</li><li>Ключ <code>"key"</code> → текстовая строка длиной 3 → <code>0x63</code> + <code>6B6579</code> (ASCII).</li><li>Значение <code>true</code> → простое значение → <code>0xF5</code>.</li><li>Ключ <code>"value"</code> → текстовая строка длиной 5 → <code>0x65</code> + <code>76616C7565</code> (ASCII).</li><li>Значение <code>42</code> → беззнаковое число → <code>0x18</code> + <code>2A</code>.</li></ol><p><strong>Итоговая последовательность байтов:</strong></p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-mathematica"><span class="hljs-variable">A2</span> <span class="hljs-number">63</span> <span class="hljs-number">6</span><span class="hljs-variable">B</span> <span class="hljs-number">65</span> <span class="hljs-number">79</span> <span class="hljs-variable">F5</span> <span class="hljs-number">65</span> <span class="hljs-number">76</span> <span class="hljs-number">61</span> <span class="hljs-number">6</span><span class="hljs-built_in">C</span> <span class="hljs-number">75</span> <span class="hljs-number">65</span> <span class="hljs-number">18</span> <span class="hljs-number">2</span><span class="hljs-variable">A</span>
		</code></div></div></pre><br>Пример CBOR (в виде последовательности байтов)
		<pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-bash">A2                   <span class="hljs-comment"># Map с двумя парами</span>
		   64                <span class="hljs-comment"># Ключ "text" (строка длиной 4)</span>
			  74657874       <span class="hljs-comment"># Значение "text" в ASCII</span>
		   63                <span class="hljs-comment"># Значение "txt" (строка длиной 3)</span>
			  747874         <span class="hljs-comment"># Значение "txt" в ASCII</span>
		   66                <span class="hljs-comment"># Ключ "nested" (строка длиной 6)</span>
			  6E6573746564   <span class="hljs-comment"># Значение "nested" в ASCII</span>
		   A1                <span class="hljs-comment"># Map с одной парой (вложенный объект)</span>
			  63             <span class="hljs-comment"># Ключ "val" (строка длиной 3)</span>
				 76616C      <span class="hljs-comment"># Значение "val" в ASCII</span>
			  02             <span class="hljs-comment"># Значение 2</span>
		</code></div></div></pre>
		</div>
	</body>
</html>